<decoder name="audisp-remote">
  <prematch>^node=</prematch>
</decoder>

<!--
Aug 19 12:43:37 customer-node01 audisp-syslog[81371]: type=SYSCALL msg=audit(1724071417.724:61337): arch=c000003e syscall=59 success=yes exit=0 a0=5606816743f0 a1=56068165f000 a2=56068166c6d0 a3=8 items=2 ppid=81319 pid=81392 auid=0 uid=0 gid=0 euid=0 suid=0 fsuid=0 egid=0 sgid=0 fsgid=0 tty=pts0 ses=2840 comm="tail" exe="/usr/bin/tail" subj=kernel key="audit-wazuh-c" ARCH=x86_64 SYSCALL=execve AUID="root" UID="root" GID="root" EUID="root" SUID="root" FSUID="root" EGID="root" SGID="root" FSGID="root"
-->
<decoder name="audisp-remote-syscall">
<parent>audisp-remote</parent>
  <prematch offset="after_parent">^\S+ type=\S+</prematch>
  <regex offset="after_parent">^(\S+) type=(\S+) msg=audit\(\d\d\d\d\d\d\d\d\d\d.\d\d\d:(\d+)\): </regex>
  <order>audit.hostname, audit.type, audit.id</order>
</decoder>

<decoder name="audisp-remote-syscall">
<parent>audisp-remote</parent>
  <regex offset="after_regex">^arch=(\S+) syscall=(\d+) success=(\S+) exit=(\S+) a0=\S+ a1=\S+ a2=\S+ a3=\S+ items=\S+ ppid=(\S+) pid=(\S+) auid=(\S+) uid=(\S+) gid=(\S+) euid=(\S+) suid=(\S+) fsuid=(\S+) egid=(\S+) sgid=(\S+) fsgid=(\S+) tty=(\S+) ses=(\S+) comm=\p(\S+)\p exe=\p(\S+)\p</regex>
  <order>audit.arch,audit.syscall,audit.success,audit.exit,audit.ppid,audit.pid,audit.auid,audit.uid,audit.gid,audit.euid,audit.suid,audit.fsuid,audit.egid,audit.sgid,audit.fsgid,audit.tty,audit.session,audit.command,audit.exe</order>
</decoder>

<!--
Aug 19 12:43:37 customer-node01 audisp-syslog[81371]: type=EXECVE msg=audit(1724071417.724:61337): argc=3 a0="tail" a1="-f" a2="/var/log/messages"
-->

<decoder name="audisp-remote-syscall">
<parent>audisp-remote</parent>
  <regex offset="after_regex">argc=(\d+) a0="(\.+)"</regex>
  <order>audit.argsc, audit.execve.a0</order>
</decoder>

<decoder name="audisp-remote-syscall">
<parent>audisp-remote</parent>
  <regex offset="after_regex">^ a1="(\.+)"</regex>
  <order>audit.execve.a1</order>
</decoder>

<decoder name="audisp-remote-syscall">
<parent>audisp-remote</parent>
  <regex offset="after_regex">^ a2="(\.+)"</regex>
  <order>audit.execve.a2</order>
</decoder>

<decoder name="audisp-remote-syscall">
<parent>audisp-remote</parent>
  <regex offset="after_regex">^ a3="(\.+)"</regex>
  <order>audit.execve.a3</order>
</decoder>

<decoder name="audisp-remote-syscall">
<parent>audisp-remote</parent>
  <regex offset="after_regex">^ a4="(\.+)"</regex>
  <order>audit.execve.a4</order>
</decoder>

<decoder name="audisp-remote-syscall">
<parent>audisp-remote</parent>
  <regex offset="after_regex">^ a5="(\.+)"</regex>
  <order>audit.execve.a5</order>
</decoder>

<decoder name="audisp-remote-syscall">
<parent>audisp-remote</parent>
  <regex offset="after_regex">^ a6="(\.+)"</regex>
  <order>audit.execve.a6</order>
</decoder>

<decoder name="audisp-remote-syscall">
<parent>audisp-remote</parent>
  <regex offset="after_regex">^ a7="(\.+)"</regex>
  <order>audit.execve.a7</order>
</decoder>

<decoder name="audisp-remote-syscall">
<parent>audisp-remote</parent>
  <regex offset="after_regex">^ a8="(\.+)"</regex>
  <order>audit.execve.a8</order>
</decoder>

<decoder name="audisp-remote-syscall">
<parent>audisp-remote</parent>
  <regex offset="after_regex">^ a9="(\.+)"</regex>
  <order>audit.execve.a9</order>
</decoder>

<decoder name="audisp-remote-syscall">
<parent>audisp-remote</parent>
  <regex offset="after_regex">^ a10="(\.+)"</regex>
  <order>audit.execve.a10</order>
</decoder>

<decoder name="audisp-remote-syscall">
<parent>audisp-remote</parent>
  <regex offset="after_regex">^ a11="(\.+)"</regex>
  <order>audit.execve.a11</order>
</decoder>

<decoder name="audisp-remote-syscall">
<parent>audisp-remote</parent>
  <regex offset="after_regex">^ a12="(\.+)"</regex>
  <order>audit.execve.a12</order>
</decoder>

<decoder name="audisp-remote-syscall">
<parent>audisp-remote</parent>
  <regex offset="after_regex">^ a13="(\.+)"</regex>
  <order>audit.execve.a13</order>
</decoder>

<decoder name="audisp-remote-syscall">
<parent>audisp-remote</parent>
  <regex offset="after_regex">^ a14="(\.+)"</regex>
  <order>audit.execve.a14</order>
</decoder>

<decoder name="audisp-remote-syscall">
<parent>audisp-remote</parent>
  <regex offset="after_regex">^ a15="(\.+)"</regex>
  <order>audit.execve.a15</order>
</decoder>

<decoder name="audisp-remote-syscall">
<parent>audisp-remote</parent>
  <regex offset="after_regex">^ a16="(\.+)"</regex>
  <order>audit.execve.a16</order>
</decoder>

<!--
Aug 19 12:43:37 customer-node01 audisp-syslog[81371]: type=CWD msg=audit(1724071417.724:61337): cwd="/root"
-->
<decoder name="audisp-remote-syscall">
<parent>audisp-remote</parent>
  <regex offset="after_parent">cwd="(\.+)"</regex>
  <order>audit.cwd</order>
</decoder>

<!--
Aug 19 12:43:37 customer-node01 audisp-syslog[81371]: type=PATH msg=audit(1724071417.724:61337): item=0 name="/usr/bin/tail" inode=25466867 dev=fc:05 mode=0400755 ouid=0 ogid=0 rdev=00:00 obj=unlabeled nametype=NORMAL cap_fp=0 cap_fi=0 cap_fe=0 cap_fver=0 cap_frootid=0 OUID="root" OGID="root"
-->
<decoder name="audisp-remote-syscall">
<parent>audisp-remote</parent>
  <regex offset="after_regex">item=\S+ name="(\.+)" inode=(\S+) dev=\S+ mode=(04\S+) ouid=\S+ ogid=\S+</regex>
  <order>audit.directory.name, audit.directory.inode, audit.directory.mode</order>
</decoder>

<!--
type=PATH msg=audit(1724071417.724:61337): item=0 name="/usr/bin/tail" inode=25466867 dev=fc:05 mode=0100755 ouid=0 ogid=0 rdev=00:00 obj=unlabeled nametype=NORMAL cap_fp=0 cap_fi=0 cap_fe=0 cap_fver=0 cap_frootid=0 OUID="root" OGID="root"
-->
<decoder name="audisp-remote-syscall">
<parent>audisp-remote</parent>
  <regex offset="after_regex">item=\S+ name="(\.+)" inode=(\S+) dev=\S+ mode=(\S+) ouid=\S+ ogid=\S+|type=PATH msg=audit\(\S+\): item=\S+ name=\((null)\) inode=(\S+) dev=\S+ mode=(\S+) ouid=\S+ ogid=\S+</regex>
  <order>audit.file.name, audit.file.inode, audit.file.mode</order>
</decoder>
